{% comment %}
  WhatsApp CTA Button for Product Pages
  
  Accepts:
  - phone: {String} WhatsApp phone number (default: +573008602789)
  - message: {String} Pre-filled message
  - product: {Object} Product object (optional, for context)
  
  Usage:
  {% render 'pdp-whatsapp-cta', 
    phone: '+573008602789',
    product: product
  %}
{% endcomment %}

{%- liquid
  assign phone = phone | default: '+573008602789'
  
  if product
    assign default_message = 'Hola! Me interesa el producto: ' | append: product.title | append: ' (' | append: shop.url | append: product.url | append: ')'
  else
    assign default_message = 'Hola! Tengo una consulta sobre un producto'
  endif
  
  assign message = message | default: default_message
  assign whatsapp_url = 'https://wa.me/' | append: phone | append: '?text=' | append: message | url_encode
-%}

<a href="{{ whatsapp_url }}" 
   class="ta-conv-pdp-whatsapp" 
   target="_blank" 
   rel="noopener noreferrer">
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M17.472 14.382C17.155 14.223 15.588 13.456 15.294 13.347C15 13.238 14.788 13.183 14.577 13.5C14.365 13.817 13.773 14.533 13.587 14.745C13.401 14.957 13.215 14.982 12.898 14.823C12.581 14.664 11.556 14.331 10.329 13.238C9.372 12.388 8.722 11.341 8.536 11.024C8.35 10.707 8.515 10.535 8.673 10.378C8.815 10.236 8.99 10.007 9.149 9.821C9.308 9.635 9.363 9.5 9.472 9.288C9.581 9.076 9.527 8.89 9.447 8.731C9.367 8.572 8.722 7.003 8.454 6.369C8.186 5.735 7.918 5.826 7.732 5.818H7.186C6.975 5.818 6.657 5.898 6.363 6.215C6.069 6.532 5.251 7.299 5.251 8.868C5.251 10.437 6.389 11.957 6.548 12.169C6.707 12.381 8.722 15.446 11.77 16.869C12.529 17.213 13.123 17.415 13.589 17.564C14.347 17.806 15.037 17.772 15.585 17.689C16.197 17.598 17.472 16.919 17.74 16.17C18.008 15.421 18.008 14.782 17.928 14.648C17.848 14.514 17.636 14.434 17.319 14.275L17.472 14.382ZM12.0001 21.789H11.996C10.241 21.789 8.527 21.311 7.03 20.409L6.676 20.195L2.882 21.151L3.855 17.466L3.62 17.098C2.63 15.55 2.101 13.762 2.102 11.922C2.104 6.485 6.564 2.026 12.004 2.026C14.657 2.027 17.165 3.06 19.053 4.95C20.941 6.84 21.972 9.349 21.971 12.002C21.969 17.439 17.509 21.898 12.069 21.898L12.0001 21.789Z" fill="currentColor"/>
  </svg>
  <span>Consultar por WhatsApp</span>
</a>
