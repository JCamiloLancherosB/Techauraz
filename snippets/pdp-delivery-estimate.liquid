{% comment %}
  Product Detail Page - Delivery Estimate Module (CANONICAL)
  
  This is the ONE AND ONLY delivery estimate component for PDP.
  Shows dynamic delivery date range: "Llega entre {minDate} y {maxDate}"
  
  Rules:
  - Cut-off: 2:00 PM Colombia time (America/Bogota)
  - If order placed before 2pm → start counting from today
  - If order placed after 2pm → start counting from next calendar day
  - Business days = Mon-Fri (excludes Sat/Sun)
  - Delivery window: 2-5 business days
  - Locale: es-CO with short month format (e.g. "30 ene")
  
  Usage:
  {% render 'pdp-delivery-estimate' %}
  
  Note: Do NOT duplicate this component elsewhere on PDP.
{% endcomment %}

<div 
  class="ta-delivery-estimate"
  data-min-days="2"
  data-max-days="5"
  data-cutoff-hour="14"
  data-timezone="America/Bogota"
  data-locale="es-CO"
  aria-live="polite" 
  aria-atomic="true"
>
  {%- comment -%} Delivery date range - main message {%- endcomment -%}
  <div class="ta-delivery-estimate__row">
    <span class="ta-delivery-estimate__icon" aria-hidden="true">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 6h12v8H3V6z" stroke="currentColor" stroke-width="2"/>
        <path d="M15 9h3l3 3v2h-6V9z" stroke="currentColor" stroke-width="2"/>
        <circle cx="7" cy="14" r="2" stroke="currentColor" stroke-width="2"/>
        <circle cx="18" cy="14" r="2" stroke="currentColor" stroke-width="2"/>
        <path d="M9 14h6" stroke="currentColor" stroke-width="2"/>
        <path d="M3 14h2" stroke="currentColor" stroke-width="2"/>
        <path d="M20 14h1" stroke="currentColor" stroke-width="2"/>
      </svg>
    </span>
    <span class="ta-delivery-estimate__text">
      {%- comment -%} 
        Fallback message shown when JS is disabled or hasn't loaded yet.
        JS will replace this text with dynamic dates once loaded.
      {%- endcomment -%}
      <strong class="ta-delivery-estimate__date-range">{{ 'products.product.delivery_estimate.fallback' | t }}</strong>
    </span>
  </div>
</div>

{%- comment -%} 
  Load the JavaScript with defer for performance.
  Script includes guard against multiple initializations.
{%- endcomment -%}
<script src="{{ 'delivery-estimate.js' | asset_url }}" defer="defer"></script>
