/* 
 * DEPENDENCIAS: 
 * - base.css (estilos base, utilidades, focus-visible, grid, scroll-behavior)
 * - animations.css (keyframes base y clases de animación)
 * 
 * NOTA: Estilos base heredados, no duplicar aquí.
 * Este archivo incluye animaciones específicas de componentes mobile (pulse-stock).
 */

/* =============================================================================
   TECHAURAZ MOBILE VISUAL FIXES - January 2024
   =============================================================================
   Version: 1.0.0
   Date: 2024-01-14
   
   Fixes for mobile view issues:
   1. Featured Products section title overlapping with header icons
   2. Cookie banner overlapping with content
   3. Hero banner benefits alignment and spacing
   4. Button contrast improvements
   5. Slider/testimonial section fixes
   6. Product card badge visibility
   ============================================================================= */

/* =============================================================================
   Z-INDEX HIERARCHY VARIABLES - Ensure consistent layering
   ============================================================================= */
:root {
  --z-header: 100;
  --z-dropdown: 200;
  --z-cookie-banner: 999;
  --z-drawer: 1000;
  --z-modal: 1001;
  --z-whatsapp: 9999;
}

/* =============================================================================
   1. FEATURED PRODUCTS SECTION - FIX TITLE OVERLAP WITH HEADER
   ============================================================================= */

@media screen and (max-width: 749px) {
  /* Add top padding to prevent overlap with fixed header */
  .section.section-featured-collection,
  .section.featured-collection,
  .collection-section,
  #MainContent .section:first-child {
    padding-top: calc(var(--header-height, 70px) + 2rem) !important;
    margin-top: 0 !important;
  }

  /* Ensure section titles have proper spacing from header */
  .section__heading,
  .title-wrapper-with-link,
  .title-wrapper,
  .collection-hero__title,
  .featured-collection .title {
    padding-top: 2rem !important;
    margin-top: 0 !important;
    position: relative !important;
    z-index: 1 !important;
  }

  /* Prevent title from being hidden behind header */
  .section-heading,
  .title-wrapper .title,
  h2.title {
    position: relative !important;
    top: 0 !important;
    clear: both !important;
  }
}

/* =============================================================================
   2. COOKIE BANNER - PREVENT CONTENT OVERLAP
   ============================================================================= */

@media screen and (max-width: 749px) {
  /* Ensure cookie banner is compact and doesn't block content */
  .cookie-banner,
  .cookie-notice,
  #cookie-banner {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    z-index: 999 !important;
    max-height: 35vh !important;
    padding: 1rem !important;
    overflow-y: auto !important;
  }

  /* When cookie banner is visible, add bottom spacing to content - with fallback */
  body.cookie-banner-visible {
    padding-bottom: 120px !important; /* Fallback for browsers without :has() support */
  }
  
  /* Modern browsers with :has() support */
  @supports selector(:has(*)) {
    body:has(.cookie-banner.is-visible) {
      padding-bottom: calc(var(--cookie-banner-height, 120px)) !important;
    }

    /* Adjust page content when cookie banner is visible */
    body:has(.cookie-banner.is-visible) .page-width:last-child,
    body:has(.cookie-banner.is-visible) #MainContent > .section:last-child {
      padding-bottom: calc(var(--cookie-banner-height, 120px) + 2rem) !important;
    }
  }
}

/* =============================================================================
   3. HERO BANNER BENEFITS - ALIGNMENT AND SPACING
   ============================================================================= */

@media screen and (max-width: 749px) {
  /* Benefits container - ensure proper grid layout */
  .benefits-grid,
  .benefits-section,
  .icon-with-text-section,
  [class*="benefits"] .grid {
    display: grid !important;
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 1rem !important;
    padding: 1.5rem 1rem !important;
    align-items: start !important;
  }

  /* Individual benefit items - proper alignment */
  .benefit-item,
  .icon-with-text,
  [class*="benefit"] {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
    padding: 1rem 0.5rem !important;
    gap: 0.5rem !important;
  }

  /* Benefit icons - consistent sizing */
  .benefit-item__icon,
  .icon-with-text__icon,
  [class*="benefit"] svg,
  [class*="benefit"] img {
    width: 32px !important;
    height: 32px !important;
    margin-bottom: 0.5rem !important;
    flex-shrink: 0 !important;
  }

  /* Benefit text - proper wrapping */
  .benefit-item__text,
  .icon-with-text__text,
  [class*="benefit"] .text {
    font-size: 1.2rem !important;
    line-height: 1.3 !important;
    color: rgba(226, 232, 240, 0.9) !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    max-width: 100% !important;
  }
}

/* =============================================================================
   4. BUTTON CONTRAST IMPROVEMENTS
   ============================================================================= */

@media screen and (max-width: 749px) {
  /* Primary CTA buttons - enhanced contrast */
  .button--primary,
  .slideshow__text .button,
  .banner__buttons .button,
  [class*="cta"] .button {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%) !important;
    color: #0f172a !important;
    border: 2px solid rgba(251, 191, 36, 0.4) !important;
    font-weight: 800 !important;
    font-size: 1.5rem !important;
    padding: 1.3rem 2rem !important;
    text-shadow: none !important;
    letter-spacing: 0.05em !important;
    text-transform: uppercase !important;
    box-shadow: 0 4px 16px rgba(245, 158, 11, 0.5) !important;
    transition: all 0.3s ease !important;
  }

  .button--primary:hover,
  .button--primary:focus {
    background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 6px 20px rgba(245, 158, 11, 0.6) !important;
  }

  /* "COMPRAR AHORA" button specific styling */
  [href*="cart/add"],
  [href*="checkout"],
  .product-form__submit,
  button[name="add"] {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%) !important;
    color: #0f172a !important;
    min-height: 48px !important;
    font-weight: 800 !important;
    border: 2px solid rgba(251, 191, 36, 0.4) !important;
  }
}

/* =============================================================================
   5. PRODUCT CARD BADGES - ENHANCED VISIBILITY
   ============================================================================= */

@media screen and (max-width: 749px) {
  /* Badge container positioning */
  .card__badge,
  .card__badges,
  .product-badge {
    position: absolute !important;
    top: 0.8rem !important;
    right: 0.8rem !important;
    z-index: 3 !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 0.5rem !important;
    max-width: calc(100% - 1.6rem) !important;
  }

  /* Individual badges - enhanced visibility */
  .badge,
  .card__badge,
  [class*="badge"] {
    display: inline-flex !important;
    padding: 0.5rem 0.9rem !important;
    border-radius: 6px !important;
    font-size: 1.05rem !important;
    font-weight: 700 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.05em !important;
    line-height: 1.2 !important;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4) !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
    -webkit-backdrop-filter: blur(4px) !important;
    backdrop-filter: blur(4px) !important;
    white-space: nowrap !important;
  }

  /* "Envío rápido" badge - amber gradient */
  .badge--shipping,
  .badge--fast-shipping,
  [class*="shipping"] {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%) !important;
    color: #ffffff !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
  }

  /* "En stock" badge - green gradient */
  .badge--stock,
  .badge--in-stock,
  [class*="stock"]:not([class*="out"]) {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;
    color: #ffffff !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
    animation: pulse-stock 2s ease-in-out infinite !important;
  }

  /* Stock badge animation - component-specific with green branding */
  @keyframes pulse-stock {
    0%, 100% {
      transform: scale(1);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
    }
    50% {
      transform: scale(1.05);
      box-shadow: 0 4px 16px rgba(16, 185, 129, 0.6);
    }
  }

  /* Note: This is a component-specific animation with green theme, different from generic pulse */

  /* Sale/discount badges - red gradient */
  .badge--sale,
  .badge--discount {
    background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%) !important;
    color: #ffffff !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
  }
}

/* =============================================================================
   6. SLIDER/CAROUSEL FIXES - PROPER CONTENT DISPLAY
   ============================================================================= */

@media screen and (max-width: 749px) {
  /* Ensure slider shows content properly
     Note: scroll-snap is progressive enhancement - older browsers will still scroll horizontally */
  .slider,
  .slideshow,
  .carousel {
    display: flex !important;
    overflow-x: auto !important;
    scroll-snap-type: x mandatory !important;
    scroll-behavior: smooth !important;
    -webkit-overflow-scrolling: touch !important;
  }

  /* Slider items - full width display
     Note: scroll-snap-align is progressive enhancement */
  .slider__slide,
  .slideshow__slide,
  .carousel__item {
    min-width: 100% !important;
    width: 100% !important;
    flex-shrink: 0 !important;
    scroll-snap-align: start !important;
    display: flex !important;
    flex-direction: column !important;
  }

  /* Slider content - ensure visibility */
  .slider__content,
  .slideshow__content,
  .carousel__content {
    display: block !important;
    width: 100% !important;
    padding: 1rem !important;
    min-height: 200px !important;
  }

  /* Slider navigation buttons - proper positioning */
  .slider-button,
  .slideshow-button,
  .carousel-button {
    position: absolute !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    z-index: 10 !important;
    width: 44px !important;
    height: 44px !important;
    min-width: 44px !important;
    min-height: 44px !important;
    border-radius: 50% !important;
    background: rgba(15, 23, 42, 0.9) !important;
    -webkit-backdrop-filter: blur(8px) !important;
    backdrop-filter: blur(8px) !important;
    border: 1px solid rgba(148, 163, 184, 0.3) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
  }

  .slider-button--prev,
  .slideshow-button--prev,
  .carousel-button--prev {
    left: 1rem !important;
  }

  .slider-button--next,
  .slideshow-button--next,
  .carousel-button--next {
    right: 1rem !important;
  }

  /* Slider counter - visible positioning */
  .slider-counter,
  .slideshow-counter,
  .carousel-counter {
    position: absolute !important;
    bottom: 1.5rem !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    z-index: 10 !important;
    background: rgba(15, 23, 42, 0.8) !important;
    -webkit-backdrop-filter: blur(8px) !important;
    backdrop-filter: blur(8px) !important;
    padding: 0.5rem 1rem !important;
    border-radius: 20px !important;
    color: #e2e8f0 !important;
    font-size: 1.3rem !important;
    font-weight: 600 !important;
    border: 1px solid rgba(148, 163, 184, 0.3) !important;
  }
}

/* =============================================================================
   7. TESTIMONIALS SECTION - FIX EMPTY SLIDER
   ============================================================================= */

@media screen and (max-width: 749px) {
  /* Main testimonials container */
  .testimonials-section,
  .testimonials,
  .product-testimonials,
  [class*="testimonial"].section {
    padding: 2rem 1rem !important;
    overflow-x: hidden !important;
  }

  /* Section title */
  .testimonials__title,
  .testimonials-section__title,
  .testimonials-section .title,
  .product-testimonials__heading,
  [class*="testimonial"] h2 {
    font-size: clamp(2rem, 5vw, 2.4rem) !important;
    color: #fbbf24 !important;
    text-align: center !important;
    margin-bottom: 1.5rem !important;
  }

  /* Testimonials slider - show content properly, prevent empty gray area */
  .testimonials__slider,
  .testimonials-slider,
  .testimonials-slider-wrapper,
  .product-testimonials__carousel {
    min-height: auto !important;
    position: relative !important;
    overflow-x: auto !important;
    overflow-y: visible !important;
  }

  /* Ensure slider displays in mobile (theme uses slider--desktop class) */
  .testimonials-slider.slider--desktop {
    display: flex !important;
    flex-wrap: nowrap !important;
  }

  /* Slider images - show properly if present */
  .testimonials__slider img,
  .testimonials-slider img,
  .testimonial__image,
  .testimonials-slider__image {
    width: 100% !important;
    height: auto !important;
    object-fit: cover !important;
    border-radius: 12px !important;
    display: block !important;
  }

  /* Testimonial cards - dark theme with brand colors */
  .testimonial-card,
  .testimonial-card__content,
  .testimonial__item,
  .product-testimonials__card,
  [class*="testimonial"] .card {
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.95) 100%) !important;
    border-radius: 12px !important;
    border: 1px solid rgba(148, 163, 184, 0.25) !important;
    padding: 1.5rem !important;
    margin-bottom: 1rem !important;
    display: block !important;
    width: 100% !important;
  }

  /* Rating stars */
  .testimonial__stars,
  .testimonial-card__rating,
  .product-testimonials__stars,
  .testimonial-card .stars {
    color: #fbbf24 !important;
    font-size: 1.4rem !important;
    margin-bottom: 1rem !important;
    display: block !important;
  }

  /* Testimonial text - prevent truncation */
  .testimonial__text,
  .testimonial__content,
  .testimonial-card__text,
  .product-testimonials__text,
  .testimonial-card p {
    font-size: 1.4rem !important;
    line-height: 1.6 !important;
    color: rgba(226, 232, 240, 0.9) !important;
    margin-bottom: 1rem !important;
    font-style: italic !important;
    /* Prevent text truncation */
    overflow: visible !important;
    text-overflow: unset !important;
    white-space: normal !important;
    max-width: 100% !important;
  }

  /* Author name */
  .testimonial__author,
  .testimonial__name,
  .testimonial-card__author-name,
  .product-testimonials__name,
  .testimonial-card .author {
    font-size: 1.3rem !important;
    font-weight: 600 !important;
    color: #fef3c7 !important;
  }

  /* Author container */
  .testimonial-card__author,
  .product-testimonials__author {
    display: flex !important;
    align-items: center !important;
    gap: 1rem !important;
    margin-top: 1rem !important;
    padding-top: 1rem !important;
    border-top: 1px solid rgba(148, 163, 184, 0.25) !important;
  }

  /* Author avatar */
  .testimonial-card__avatar,
  .product-testimonials__avatar {
    flex-shrink: 0 !important;
    width: 50px !important;
    height: 50px !important;
    border-radius: 50% !important;
  }

  .testimonial-card__avatar img,
  .product-testimonials__avatar img,
  .testimonial-card__avatar svg,
  .product-testimonials__avatar svg {
    width: 50px !important;
    height: 50px !important;
    border-radius: 50% !important;
    object-fit: cover !important;
  }

  /* Testimonials grid (non-slider layout) */
  .testimonials__grid,
  .testimonials-grid {
    display: grid !important;
    grid-template-columns: 1fr !important;
    gap: 1.5rem !important;
  }

  /* Slider controls - counter positioned closer to content than general sliders */
  .testimonials .slider-counter,
  .testimonials-section .slider-counter,
  .slider-buttons .slider-counter {
    bottom: 1rem !important; /* Closer than general slider-counter (1.5rem) */
  }

  /* Slider navigation buttons */
  .slider-button,
  .slider-button--prev,
  .slider-button--next {
    background: rgba(15, 23, 42, 0.9) !important;
    border: 1px solid rgba(148, 163, 184, 0.3) !important;
    width: 44px !important;
    height: 44px !important;
    border-radius: 50% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: #fbbf24 !important;
  }

  /* Slider indicator dots */
  .product-testimonials__dots,
  .testimonials__dots {
    display: flex !important;
    justify-content: center !important;
    gap: 0.75rem !important;
    margin-top: 1.5rem !important;
  }

  .product-testimonials__dot,
  .slider-counter__link .dot {
    width: 10px !important;
    height: 10px !important;
    border-radius: 50% !important;
    background: rgba(148, 163, 184, 0.5) !important;
    transition: all 0.3s ease !important;
  }

  .product-testimonials__dot.active,
  .slider-counter__link--active .dot {
    background: #fbbf24 !important;
    transform: scale(1.3) !important;
  }
}

/* =============================================================================
   8. "¿POR QUÉ COMPRAR CON TECHAURAZ?" SECTION - SPACING FIX
   ============================================================================= */

@media screen and (max-width: 749px) {
  /* Benefits section container */
  .benefits-conversion,
  .why-buy-section,
  [class*="benefits-conversion"] {
    padding: 2rem 1rem !important;
    margin: 2rem 0 !important;
  }

  /* Benefits grid layout */
  .benefits-conversion__grid,
  .why-buy-section__grid {
    display: grid !important;
    grid-template-columns: 1fr !important;
    gap: 1.5rem !important;
  }

  /* Individual benefit items */
  .benefits-conversion__item,
  .why-buy-section__item {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
    padding: 1.5rem 1rem !important;
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.95) 100%) !important;
    border-radius: 12px !important;
    border: 1px solid rgba(148, 163, 184, 0.25) !important;
  }
}

/* =============================================================================
   9. "AGREGAR AL CARRITO" BUTTONS - CONSISTENT STYLING
   ============================================================================= */

@media screen and (max-width: 749px) {
  /* Add to cart buttons - consistent style */
  .quick-add__submit,
  .product-form__submit,
  button[name="add"],
  [class*="add-to-cart"] {
    width: 100% !important;
    min-height: 48px !important;
    padding: 1.1rem 1.5rem !important;
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%) !important;
    color: #0f172a !important;
    border: 2px solid rgba(251, 191, 36, 0.4) !important;
    font-size: 1.3rem !important;
    font-weight: 700 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.05em !important;
    border-radius: 8px !important;
    box-shadow: 0 2px 10px rgba(245, 158, 11, 0.4) !important;
    transition: all 0.3s ease !important;
    text-align: center !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  .quick-add__submit:hover,
  .quick-add__submit:focus,
  .product-form__submit:hover,
  .product-form__submit:focus {
    background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 14px rgba(245, 158, 11, 0.5) !important;
  }
}

/* =============================================================================
   10. GENERAL MOBILE SPACING IMPROVEMENTS
   ============================================================================= */

@media screen and (max-width: 749px) {
  /* Ensure sections have proper spacing */
  .section {
    padding-top: 3rem !important;
    padding-bottom: 3rem !important;
  }

  /* Page width containers */
  .page-width {
    padding-left: 1.5rem !important;
    padding-right: 1.5rem !important;
    max-width: 100% !important;
  }

  /* Prevent horizontal overflow */
  body,
  #MainContent,
  .main-content {
    overflow-x: hidden !important;
    max-width: 100vw !important;
  }

  /* Product card spacing */
  .product-grid .grid__item {
    padding: 0 0.5rem !important;
    margin-bottom: 1.5rem !important;
  }
}

/* =============================================================================
   11. ACCESSIBILITY - REDUCED MOTION SUPPORT
   ============================================================================= */

/* Note: Reduced motion handling is covered by animations.css */

/* =============================================================================
   END OF MOBILE VISUAL FIXES
   ============================================================================= */
